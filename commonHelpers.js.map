{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nconst searchFormRef = document.querySelector('.search-form');\nconst galleryRef = document.querySelector('.gallery');\nconst spanLoaderRef = document.querySelector('.span-loader');\nconst loadMoreBtnRef = document.getElementById('btn');\n\nconsole.log(loadMoreBtnRef);\n\n// import { renderGallery } from './js/renderGallery';\n\nconst apiKey = '41747369-46a857856bf510ac3748d6666';\n\nconst getImages = async params => {\n  try {\n    const response = await axios.get('https://pixabay.com/api/', { params });\n\n    return response.data;\n  } catch {\n    e => console.log(e);\n  }\n};\n\nconst createGetImagesRequest = q => {\n  let page = 1;\n  const per_page = 40;\n  let lastPage = false;\n\n  return async () => {\n    try {\n      if (lastPage) return;\n      const params = {\n        key: apiKey,\n        q,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page,\n      };\n      const { hits, totalHits } = await getImages(params);\n\n      if (page >= Math.ceil(totalHits / per_page)) {\n        lastPage = true;\n      }\n\n      page += 1;\n\n      return hits;\n    } catch (error) {\n      console.log(error);\n    }\n  };\n};\n\nconst renderImages = (hits = []) => {\n  const markup = hits.reduce(\n    (html, img) =>\n      html +\n      `<li class=\"img-item\">\n      <div class=\"img\">\n  <a class=\"img-link\" href=\"${img.largeImageURL}\">\n    <img\n      class=\"images\"\n      src=\"${img.webformatURL}\"\n      data-source=\"${img.largeImageURL}\"\n      alt=\"${img.tags}\"\n      width=\"360\"\n      height=\"200\"\n  /></a></div>\n<div class=\"description\">\n  <div class=\"category\">\n    <p><b>Likes</b></p>\n    <p>${img.likes}</p>\n  </div>\n  <div>\n    <p><b>Views</b></p>\n    <p>${img.views}</p>\n  </div>\n  <div>\n    <p><b>Comments</b></p>\n    <p>${img.comments}</p>\n  </div>\n  <div>\n    <p><b>Downloads</b></p>\n    <p>${img.downloads}</p>\n  </div>\n</div>\n</li>`,\n    ''\n  );\n  galleryRef.insertAdjacentHTML('beforeend', markup);\n};\n\nlet doFetch = null;\n\nsearchFormRef.addEventListener('submit', async evt => {\n  evt.preventDefault();\n  if (doFetch != null) {\n    loadMoreBtnRef.removeEventListener('click', doFetch);\n  }\n\n  const data = new FormData(evt.currentTarget);\n  const query = data.get('query').trim();\n  galleryRef.innerHTML = '';\n  const fetchImages = createGetImagesRequest(query);\n  doFetch = async () => {\n    const hits = await fetchImages();\n    renderImages(hits);\n  };\n\n  await doFetch();\n  loadMoreBtnRef.classList.remove('is-hidden');\n  loadMoreBtnRef.addEventListener('click', doFetch);\n});\n"],"names":["searchFormRef","galleryRef","loadMoreBtnRef","apiKey","getImages","params","axios","createGetImagesRequest","q","page","per_page","lastPage","hits","totalHits","error","renderImages","markup","html","img","doFetch","evt","query","fetchImages"],"mappings":"svBAMA,MAAMA,EAAgB,SAAS,cAAc,cAAc,EACrDC,EAAa,SAAS,cAAc,UAAU,EAC9B,SAAS,cAAc,cAAc,EAC3D,MAAMC,EAAiB,SAAS,eAAe,KAAK,EAEpD,QAAQ,IAAIA,CAAc,EAI1B,MAAMC,EAAS,qCAETC,EAAY,MAAMC,GAAU,CAChC,GAAI,CAGF,OAFiB,MAAMC,EAAM,IAAI,2BAA4B,CAAE,OAAAD,CAAM,CAAE,GAEvD,IACpB,MAAI,CAED,CACH,EAEME,EAAyBC,GAAK,CAClC,IAAIC,EAAO,EACX,MAAMC,EAAW,GACjB,IAAIC,EAAW,GAEf,MAAO,UAAY,CACjB,GAAI,CACF,GAAIA,EAAU,OACd,MAAMN,EAAS,CACb,IAAKF,EACL,EAAAK,EACA,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAAC,CACR,EACY,CAAE,KAAAE,EAAM,UAAAC,CAAS,EAAK,MAAMT,EAAUC,CAAM,EAElD,OAAII,GAAQ,KAAK,KAAKI,EAAYH,CAAQ,IACxCC,EAAW,IAGbF,GAAQ,EAEDG,CACR,OAAQE,EAAP,CACA,QAAQ,IAAIA,CAAK,CAClB,CACL,CACA,EAEMC,EAAe,CAACH,EAAO,KAAO,CAClC,MAAMI,EAASJ,EAAK,OAClB,CAACK,EAAMC,IACLD,EACA;AAAA;AAAA,8BAEwBC,EAAI;AAAA;AAAA;AAAA,aAGrBA,EAAI;AAAA,qBACIA,EAAI;AAAA,aACZA,EAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAORA,EAAI;AAAA;AAAA;AAAA;AAAA,SAIJA,EAAI;AAAA;AAAA;AAAA;AAAA,SAIJA,EAAI;AAAA;AAAA;AAAA;AAAA,SAIJA,EAAI;AAAA;AAAA;AAAA,OAIT,EACJ,EACEjB,EAAW,mBAAmB,YAAae,CAAM,CACnD,EAEA,IAAIG,EAAU,KAEdnB,EAAc,iBAAiB,SAAU,MAAMoB,GAAO,CACpDA,EAAI,eAAc,EACdD,GAAW,MACbjB,EAAe,oBAAoB,QAASiB,CAAO,EAIrD,MAAME,EADO,IAAI,SAASD,EAAI,aAAa,EACxB,IAAI,OAAO,EAAE,KAAI,EACpCnB,EAAW,UAAY,GACvB,MAAMqB,EAAcf,EAAuBc,CAAK,EAChDF,EAAU,SAAY,CACpB,MAAMP,EAAO,MAAMU,IACnBP,EAAaH,CAAI,CACrB,EAEE,MAAMO,EAAO,EACbjB,EAAe,UAAU,OAAO,WAAW,EAC3CA,EAAe,iBAAiB,QAASiB,CAAO,CAClD,CAAC"}